svd1$d
head(constantMatrix)
svd2$d
svd2$v[,c(1,2)]
svd2$d
dim(faceData)
al <- svd1$u * svd1$d * svd1$v
a1 <- (svd1$u[,1] * svd1$d[1]) %*% t(svd1$v[,1])
myImage(al)
myImage(al)
myImage(a1)
a2 <- svdq$u[,c(1,2)] %*% diag(svd1$d[1:2]) %*% svd1$v
a2 <- svd1$u[,c(1,2)] %*% diag(svd1$d[1:2]) %*% svd1$v
a2 <- svd1$u[,1,2] %*% diag(svd1$d[1:2]) %*% svd1$v
a2 <- svd1$u[,c(1:2)] %*% diag(svd1$d[1:2]) %*% svd1$v
a2 <- svd1$u[1:2] %*% diag(svd1$d[1:2]) %*% t(svd1$v[1:2])
a2 <- (svd1$u[1:2] %*% diag(svd1$d[1:2])) %*% t(svd1$v[1:2])
a2 <- svd1$u[1:2] %*% diag(svd1$d[1:2])
a2 <- (svd1$u[,1:2] %*% diag(svd1$d[1:2])) %*% t(svd1$v[,1:2])
a2 <- svd1$u[,1:2] %*% diag(svd1$d[1:2]) %*% t(svd1$v[,1:2])
myImage(a2)
a2 <- svd1$u[,1:5] %*% diag(svd1$d[1:5]) %*% t(svd1$v[,1:5])
myImage(svd1$u[,1:5] %*% diag(svd1$d[1:5]) %*% t(svd1$v[,1:5]))
myImage(svd1$u[,1:10] %*% diag(svd1$d[1:10]) %*% t(svd1$v[,1:10]))
NEI <- readRDS("data/summarySCC_PM25.rds")
SCC <- readRDS("data/Source_Classification_Code.rds")
SCC <- readRDS("data/Source_Classification_Code.rds")
NEI <- readRDS("data/summarySCC_PM25.rds")
View(SCC)
View(NEI)
unique(NEI$Pollutant)
unique(NEI$fips)
unique(NEI$year)
unique(NEI$type)
tapply(NEI$Emissions, NEI$year, sum)
plot(tapply(NEI$Emissions, NEI$year, sum))
?plot
plot(tapply(NEI$Emissions, NEI$year, sum), type = "l")
baltNEI <- NEI[NEI$fip == "24510", ]
plot(tapply(baltNEI$Emissions, baltNEI$year, sum), type = "l")
plot(tapply(NEI$Emissions, NEI$year, sum), type = "l")
a <- tapply(NEI$Emissions, NEI$year, sum)
a <- tapply(NEI$Emissions, NEI$year, sum)
plot(a, type = "l")
a
t(a)
type(a)
class(a)
a <- data.frame(tapply(NEI$Emissions, NEI$year, sum))
a
plot(a, type = "l")
plot(a, type = "l")
plot(a, type = "l", xlab = row.names(a))
plot(a, row.names(a), type = "l")
plot(row.names(a), a,type = "l")
plot(row.names(a), a[1],type = "l")
row.names(a)
a[1]
a <- tapply(NEI$Emissions, NEI$year, sum)
names(a)
plot(names(a), a,type = "l")
png("graphs/wk4_1.png")
plot(names(a), a,type = "l")
dev.off()
baltNEI <- NEI[NEI$fip == "24510", ]
a <- tapply(baltNEI$Emissions, baltNEI$year, sum)
plot(names(a),a, type = "l")
png("graphs/wk4_2.png")
plot(names(a),a, type = "l")
dev.off()
a <- tapply(baltNEI$Emissions, c(baltNEI$year, baltNEI$type), sum)
a <- aggregate(baltNEI$Emissions, by = list(baltNEI$year, baltNEI$type), sum)
a
names(a) <- c("Year","Type","TotalEm")
qplot(a)
library(ggplot2)
qplot(a)
?qplot
qplot(Year ~ TotalEm, data = a, col = Type)
ggplot(Year ~ TotalEm, data = a, col = Type)
qgplot(TotalEm, data = a, col = Type)
qplot(TotalEm, data = a, col = Type)
names(baltNEI)
qplot(mpg, wt, data = mtcars, colour = cyl)
qplot(Year, Emissions, data = baltNEI, col = type, geom = "line")
qplot(year, Emissions, data = baltNEI, col = type, geom = "line")
qplot(year, Emissions, data = baltNEI, col = type, geom = "point")
names(a) <- c("year","type","Emissions")
qplot(year, Emissions, data = a, col = type, geom = "point")
qplot(year, Emissions, data = a, col = type, geom = "line")
png("graphs/wk4_3.png")
qplot(year, Emissions, data = a, col = type, geom = "line")
dev.off()
qplot(year, Emissions, data = a, col = type, geom = c("point", "line"))
png("graphs/wk4_3.png")
qplot(year, Emissions, data = a, col = type, geom = c("point", "line"))
dev.off()
unique(SCC$SCC.Level.One)
unique(SCC$SCC.Level.Two)
grep("Coal", SCC$SCC.Level.Three)
?grep
grepl("Coal", SCC$SCC.Level.Three)
sum(grepl("Coal", SCC$SCC.Level.Three))
grepl("Coal", SCC$SCC.Level.Three) | grepl("Coal", SCC$SCC.Level.Three)
sum(grepl("Coal", SCC$SCC.Level.Three) | grepl("Coal", SCC$SCC.Level.Three))
combSCCs <- SCC$SCC[grepl("Coal", SCC$SCC.Level.Three) | grepl("Coal", SCC$SCC.Level.Three)]
NEI$SCC %in% combSCCs
sum(NEI$SCC %in% combSCCs)
combSCCs
x <- NEI[NEI$SCC %in% combSCCs,]
a <- tapply(x$Emissions, x$year, sum)
a
a <- aggregate(x$Emissions, by=list(x$year), sum)
a
names(a) <- c("year","Emissions")
qplot(year, Emissions, data = a, geom = c("point", "line"))
png("graphs/wk4_4.png")
qplot(year, Emissions, data = a, geom = c("point", "line"))
dev.off()
combSCCs <-  SCC$SCC[SCC$SCC.Level.Three == "Fuel Comb - Electric Generation - Coal",]
names(SCC)
combSCCs <-  SCC$SCC[SCC$EI.Sector == "Fuel Comb - Electric Generation - Coal",]
SCC$EI.Sector == "Fuel Comb - Electric Generation - Coal",
SCC$EI.Sector == "Fuel Comb - Electric Generation - Coal"
sum(SCC$EI.Sector == "Fuel Comb - Electric Generation - Coal")
combSCCs <-  SCC$SCC[SCC$EI.Sector == "Fuel Comb - Electric Generation - Coal"]
lapply(SCC,names)
lapply(SCC,unique)
unique(SCC$EI.Sector)
unique(SCC$Data.Category)
grepl("Motor", SCC$SCC.Level.Three)
sum(grepl("Motor", SCC$SCC.Level.Three))
sum(grepl("motor", SCC$SCC.Level.Three))
sum(grepl("Motor", SCC$SCC.Level.Three))
unique(SCC$SCC.Level.Three[grep("Motor", SCC$SCC.Level.Three))])
unique(SCC$SCC.Level.Three[grep("Motor", SCC$SCC.Level.Three)])
unique(SCC$Short.Name[grep("Motor", SCC$Short.Name)])
unique(SCC$Short.Name[grep("Motor Vehicle", SCC$Short.Name)])
motSCCs <- SCC$SCC[grep("Motor Vehicle", SCC$Short.Name)]
motSCCs
motSCCs <- SCC$SCC[grep("Motor Vehicle", SCC$Short.Name)]
x <- NEI[NEI$SCC %in% motSCCs,]
a <- aggregate(x$Emissions, by = list(x$year), sum)
qplot(year, Emissions, data = a, geom = c("point", "line"))
x <- NEI[NEI$SCC %in% motSCCs,]
a <- aggregate(x$Emissions, by = list(x$year), sum)
names(a) <- c("year","Emissions")
qplot(year, Emissions, data = a, geom = c("point", "line"))
a
a <- aggregate(x$Emissions, by = list(x$year), mean)
names(a) <- c("year","Emissions")
qplot(year, Emissions, data = a, geom = c("point", "line"))
a <- aggregate(x$Emissions, by = list(x$year), sum)
names(a) <- c("year","Emissions")
qplot(year, Emissions, data = a, geom = c("point", "line"))
x <- baltNEI[baltNEI$SCC %in% motSCCs,]
a <- aggregate(x$Emissions, by = list(x$year), sum)
names(a) <- c("year","Emissions")
qplot(year, Emissions, data = a, geom = c("point", "line"))
motSCCs <- SCC$SCC[grep("Motor", SCC$Short.Name)]
x <- baltNEI[baltNEI$SCC %in% motSCCs,]
a <- aggregate(x$Emissions, by = list(x$year), sum)
names(a) <- c("year","Emissions")
qplot(year, Emissions, data = a, geom = c("point", "line"))
sort(unique(SCC$SCC.Level.One))
sort(unique(SCC$SCC.Level.Two))
motSCCs <- SCC$SCC[SCC$SCC.Level.One == "Mobile Sources"]
x <- baltNEI[baltNEI$SCC %in% motSCCs,]
a <- aggregate(x$Emissions, by = list(x$year), sum)
names(a) <- c("year","Emissions")
qplot(year, Emissions, data = a, geom = c("point", "line"))
qplot(year, Emissions, data = a, geom = c("point", "line"))
library(ggplot2)
unique(SCC$EI.Sector)
unique(SCC$Short.Name[grep("Motor Vehicle", SCC$Short.Name)])
motSCCs <- SCC$SCC[SCC$SCC.Level.One == "Mobile Sources"]
x <- baltNEI[baltNEI$SCC %in% motSCCs,]
a <- aggregate(x$Emissions, by = list(x$year), sum)
names(a) <- c("year","Emissions")
qplot(year, Emissions, data = a, geom = c("point", "line"))
laVbalNEI <- NEI[(NEI$fip == "06037" | NEI$fip == "24510") &  NEI$SCC %in% motSCCs, ]
thing <- switch(laVbalNEI$fips, "06037" = "LA", "24510" = "Baltimore City")
thing <- lapply(laVbalNEI$fips, function(x){switch(x, "06037" = "LA", "24510" = "Baltimore City")}
)
thing
str(thing)
laVbalNEI$city <- lapply(laVbalNEI$fips, function(x){switch(x, "06037" = "LA", "24510" = "Baltimore City")})
laVbalNEI$city
View(laVbalNEI)
a <- aggregate(laVbalNEI$Emissions, by = list(laVbalNEI$year,laVbalNEI$city), sum)
list(laVbalNEI$year,laVbalNEI$city)
str(laVbalNEI)
laVbalNEI$city <- as.vector(lapply(laVbalNEI$fips, function(x){
switch(x, "06037" = "LA", "24510" = "Baltimore City")}
))
a <- aggregate(laVbalNEI$Emissions, by = list(laVbalNEI$year,laVbalNEI$city), sum)
str(laVbalNEI)
laVbalNEI$city <- unlist(lapply(laVbalNEI$fips, function(x){
switch(x, "06037" = "LA", "24510" = "Baltimore City")}
))
str(laVbalNEI)
a <- aggregate(laVbalNEI$Emissions, by = list(laVbalNEI$year,laVbalNEI$city), sum)
a
names(a) <- c("year","city","Emissions")
qplot(year, Emissions, data = a, col = city, geom = c("point", "line"))
?by
tmp <- with(warpbreaks,
by(warpbreaks, tension,
function(x) lm(breaks ~ wool, data = x)))
sapply(tmp, coef)
by(laVbalNEI, laVbalNEI$fips,scale)
?scale
laVbalNEI <- NEI[(NEI$fip == "06037" | NEI$fip == "24510") &  (NEI$SCC %in% motSCCs) &
!is.na(NEI$Emissions), ]
by(laVbalNEI, laVbalNEI$fips,scale)
traceback()
?tapply
tapply(laVbalNEI, laVbalNEI$fips,scale)
traceback()
tapply(laVbalNEI$Emissions, laVbalNEI$fips,scale)
laVbalNEI$Emissions_Scaled <- tapply(laVbalNEI$Emissions, laVbalNEI$fips,scale)
mean(laVbalNEI$Emissions_Scaled)
str(laVbalNEI)
thing <- scale(laVbalNEI$Emissions)
thing
str(thing)
thing <- as.numeric(scale(laVbalNEI$Emissions))
str(thing)
laVbalNEI$Emissions_Scaled <- tapply(laVbalNEI$Emissions, laVbalNEI$fips,as.numeric(scale))
laVbalNEI$Emissions_Scaled <- tapply(laVbalNEI$Emissions, laVbalNEI$fips, function(x){
as.numeric(scale(x))})
mean(laVbalNEI$Emissions_Scaled)
laVbalNEI$Emissions_Scaled <- tapply(laVbalNEI$Emissions, laVbalNEI$fips, function(x){
unlitst(as.numeric(scale(x)))})
laVbalNEI$Emissions_Scaled <- tapply(laVbalNEI$Emissions, laVbalNEI$fips, function(x){
unlist(as.numeric(scale(x)))})
laVbalNEI$Emissions_Scaled <-
thing <- tapply(laVbalNEI$Emissions, laVbalNEI$fips, function(x){
unlist(as.numeric(scale(x)))})
laVbalNEI$Emissions_Scaled <-
thing <- tapply(laVbalNEI$Emissions, laVbalNEI$fips, function(x){
unlist(unlist(as.numeric(scale(x))))})
laVbalNEI$Emissions_Scaled <-
thing <- by(laVbalNEI$Emissions, laVbalNEI$fips, function(x){
unlist(unlist(as.numeric(scale(x))))})
c(thing[1:2])
newThing <- c(thing[1:2])
newThing <- unlist(c(thing[1:2]))
laVbalNEI$Emissions_Scaled <-
thing <- by(laVbalNEI$Emissions, laVbalNEI$fips, function(x){
unlist(as.numeric(scale(x))))})
laVbalNEI$Emissions_Scaled <-
thing <- by(laVbalNEI$Emissions, laVbalNEI$fips, function(x){
unlist(as.numeric(scale(x)))})
newThing <- unlist(c(thing[1:2]))
mean(newThing)
summary(newThing)
summary(scale(laVbalNEI$Emissions))
summary(laVbalNEI$Emissions)
hist(laVbalNEI$Emissions)
plot(laVbalNEI$Emissions)
boxplot(laVbalNEI$Emissions)
boxplot(log10(laVbalNEI$Emissions))
otherThing <- as.numeric(scale(laVbalNEI$Emissions))
thing <- by(laVbalNEI$Emissions, laVbalNEI$fips, function(x){
unlist(as.numeric(scale(x)))})
summary(thing)
summary(otherThing)
newThing <- unlist(c(thing[1:2]))
summary(newThing)
laVbalNEI$Emissions_Scaled <- newThing
laVbalNEI$city <- unlist(lapply(laVbalNEI$fips, function(x){
switch(x, "06037" = "LA", "24510" = "Baltimore City")}
))
a <- aggregate(laVbalNEI$Emissions, by = list(laVbalNEI$year,laVbalNEI$city), sum)
names(a) <- c("year","city","Emissions")
qplot(year, Emissions, data = a, col = city, geom = c("point", "line"))
a <- aggregate(laVbalNEI$Emissions_Scaled, by = list(laVbalNEI$year,laVbalNEI$city), sum)
names(a) <- c("year","city","Emissions")
qplot(year, Emissions, data = a, col = city, geom = c("point", "line"))
a
a <- aggregate(laVbalNEI$Emissions_Scaled, by = list(laVbalNEI$year,laVbalNEI$city), mean)
names(a) <- c("year","city","Emissions")
qplot(year, Emissions, data = a, col = city, geom = c("point", "line"))
install.packages("radiant", repos = "https://radiant-rstats.github.io/minicran/", type = 'binary')
radiant:::radiant()
install.packages("quantreg")
radiant:::radiant()
radiant:::radiant()
a <- tapply(NEI$Emissions, NEI$year, sum)
plot(names(a), a,type = "l")
plot(names(a), a,type = "l", main ="Total PM2.5 from all sources", xlab = "Year", yab = "PM2.5")
plot(names(a), a,type = "l", main ="Total PM2.5 from all sources", xlab = "Year", ylab = "PM2.5")
warnings()
plot(names(a), a,type = "l", main ="Total PM2.5 from all sources", xlab = "Year", ylab = "PM2.5")
png("graphs/wk4_1.png")
plot(names(a), a,type = "l", main = "Total PM2.5 from all sources", xlab = "Year", ylab = "PM2.5")
dev.off()
baltNEI <- NEI[NEI$fip == "24510", ]
a <- tapply(baltNEI$Emissions, baltNEI$year, sum)
plot(names(a),a, type = "l")
a
plot(names(a),a, type = "l", main = "Baltimore City, Maryland PM2.5", ylab = "PM2.5", xlab = "Year")
png("graphs/wk4_2.png")
plot(names(a),a, type = "l", main = "Baltimore City, Maryland PM2.5", ylab = "PM2.5", xlab = "Year")
dev.off()
png("graphs/wk4_1.png")
plot(names(a), a,type = "l", main = "Total PM2.5 From All Sources", xlab = "Year", ylab = "PM2.5")
dev.off()
png("graphs/wk4_2.png")
plot(names(a),a, type = "l", main = "Baltimore City, Maryland Total PM2.5", ylab = "PM2.5", xlab = "Year")
dev.off()
baltNEI <- NEI[NEI$fip == "24510", ]
a <- aggregate(baltNEI$Emissions, by = list(baltNEI$year, baltNEI$type), sum)
names(a) <- c("year","type","Emissions")
qplot(year, Emissions, data = a, col = type, geom = c("point", "line"))
library(ggplot2)
qplot(year, Emissions, data = a, col = type, geom = c("point", "line"))
qplot(year, Emissions, data = a, col = type, geom = c("point", "line"),
main = "PM2.5 emission type between 1999 and 2008",
ylab = "Yea")
qplot(year, Emissions, data = a, col = type, geom = c("point", "line"),
main = "PM2.5 emission type between 1999 and 2008",
xlab = "Year")
qplot(year, Emissions, data = a, col = type, geom = c("point", "line"),
main = "Baltimore City PM2.5 emission by type between 1999 and 2008",
xlab = "Year")
combSCCs <- SCC$SCC[grepl("Coal", SCC$SCC.Level.Three) | grepl("Coal", SCC$SCC.Level.Three)]
x <- NEI[NEI$SCC %in% combSCCs,]
a <- aggregate(x$Emissions, by = list(x$year), sum)
names(a) <- c("year","Emissions")
qplot(year, Emissions, data = a, geom = c("point", "line"))
qplot(year, Emissions, data = a, geom = c("point", "line"), xlab = "Year",
main = " US coal combustion related emissions between 1999 and 2008")
unique(SCC$EI.Sector)
unique(SCC$Short.Name[grep("Motor Vehicle", SCC$Short.Name)])
motSCCs <- SCC$SCC[SCC$SCC.Level.One == "Mobile Sources"]
x <- baltNEI[baltNEI$SCC %in% motSCCs,]
a <- aggregate(x$Emissions, by = list(x$year), sum)
names(a) <- c("year","Emissions")
qplot(year, Emissions, data = a, geom = c("point", "line"))
qplot(year, Emissions, data = a, geom = c("point", "line"),
main = "Emissions from Mobile Sources in Baltimore City from 1999 to 2008",
xlab = "Year")
png("graphs/wk4_5.png")
qplot(year, Emissions, data = a, geom = c("point", "line"),
main = "Emissions from Mobile Sources in Baltimore City from 1999 to 2008",
xlab = "Year")
dev.off()
qplot(year, Emissions, data = a, col = city, geom = c("point", "line"))
laNEI <- NEI[NEI$fip == "06037" &  NEI$SCC %in% motSCCs, ]
laVbalNEI <- NEI[(NEI$fip == "06037" | NEI$fip == "24510") &  (NEI$SCC %in% motSCCs) &
!is.na(NEI$Emissions), ]
otherThing <- as.numeric(scale(laVbalNEI$Emissions))
thing <- by(laVbalNEI$Emissions, laVbalNEI$fips, function(x){
unlist(as.numeric(scale(x)))})
newThing <- unlist(c(thing[1:2]))
laVbalNEI$Emissions_Scaled <- newThing
laVbalNEI$city <- unlist(lapply(laVbalNEI$fips, function(x){
switch(x, "06037" = "LA", "24510" = "Baltimore City")}
))
a <- aggregate(laVbalNEI$Emissions_Scaled, by = list(laVbalNEI$year,laVbalNEI$city), mean)
names(a) <- c("year","city","Emissions")
qplot(year, Emissions, data = a, col = city, geom = c("point", "line"))
qplot(year, Emissions, data = a, col = city, geom = c("point", "line"),
main = "Baltimore City and LA Emissions from Mobile Sources 1999-2008 (Z-scores)")
qplot(year, Emissions, data = a, col = city, geom = c("point", "line"),
main = "Baltimore City and LA Emissions from Mobile Sources 1999-2008 (Z-scores)",
xlab = "Year")
png("wk4_1.png")
plot(names(a), a,type = "l", main = "Total PM2.5 From All Sources", xlab = "Year", ylab = "PM2.5")
dev.off()
a <- tapply(NEI$Emissions, NEI$year, sum)
png("wk4_1.png")
plot(names(a), a,type = "l", main = "Total PM2.5 From All Sources", xlab = "Year", ylab = "PM2.5")
dev.off()
baltNEI <- NEI[NEI$fip == "24510", ]
a <- tapply(baltNEI$Emissions, baltNEI$year, sum)
png("wk4_2.png")
plot(names(a),a, type = "l", main = "Baltimore City, Maryland Total PM2.5", ylab = "PM2.5", xlab = "Year")
dev.off()
baltNEI <- NEI[NEI$fip == "24510", ]
a <- aggregate(baltNEI$Emissions, by = list(baltNEI$year, baltNEI$type), sum)
names(a) <- c("year","type","Emissions")
png("wk4_3.png")
qplot(year, Emissions, data = a, col = type, geom = c("point", "line"),
main = "Baltimore City PM2.5 emission by type between 1999 and 2008",
xlab = "Year")
dev.off()
combSCCs <- SCC$SCC[grepl("Coal", SCC$SCC.Level.Three) | grepl("Coal", SCC$SCC.Level.Three)]
x <- NEI[NEI$SCC %in% combSCCs,]
a <- aggregate(x$Emissions, by = list(x$year), sum)
names(a) <- c("year","Emissions")
png("graphs/wk4_4.png")
qplot(year, Emissions, data = a, geom = c("point", "line"), xlab = "Year",
main = " US coal combustion related emissions between 1999 and 2008")
dev.off()
setwd("caseStudy")
# 1. Have total emissions from PM2.5 decreased in the United States from 1999 to 2008? Using the base plotting system, make a plot showing the total PM2.5 emission from all sources for each of the years 1999, 2002, 2005, and 2008.
a <- tapply(NEI$Emissions, NEI$year, sum)
png("wk4_1.png")
plot(names(a), a,type = "l", main = "Total PM2.5 From All Sources", xlab = "Year", ylab = "PM2.5")
dev.off()
# Emissions have decreased
# 2. Have total emissions from PM2.5 decreased in the Baltimore City, Maryland (fips == "24510") from 1999 to 2008? Use the base plotting system to make a plot answering this question.
baltNEI <- NEI[NEI$fip == "24510", ]
a <- tapply(baltNEI$Emissions, baltNEI$year, sum)
png("wk4_2.png")
plot(names(a),a, type = "l", main = "Baltimore City, Maryland Total PM2.5", ylab = "PM2.5", xlab = "Year")
dev.off()
# Emissions initially rose in 2005 but the falling trend continued in 2008
# 3. Of the four types of sources indicated by the type (point, nonpoint, onroad, nonroad) variable, which of these four sources have seen decreases in emissions from 1999–2008 for Baltimore City? Which have seen increases in emissions from 1999–2008? Use the ggplot2 plotting system to make a plot answer this question.
baltNEI <- NEI[NEI$fip == "24510", ]
a <- aggregate(baltNEI$Emissions, by = list(baltNEI$year, baltNEI$type), sum)
names(a) <- c("year","type","Emissions")
png("wk4_3.png")
qplot(year, Emissions, data = a, col = type, geom = c("point", "line"),
main = "Baltimore City PM2.5 emission by type between 1999 and 2008",
xlab = "Year")
dev.off()
# Non-road, Nonpoint, and On-Road have decreased while Point has increased
# 4. Across the United States, how have emissions from coal combustion-related sources changed from 1999–2008?
combSCCs <- SCC$SCC[grepl("Coal", SCC$SCC.Level.Three) | grepl("Coal", SCC$SCC.Level.Three)]
# combSCCs <-  SCC$SCC[SCC$EI.Sector == "Fuel Comb - Electric Generation - Coal"]
x <- NEI[NEI$SCC %in% combSCCs,]
a <- aggregate(x$Emissions, by = list(x$year), sum)
names(a) <- c("year","Emissions")
png("wk4_4.png")
qplot(year, Emissions, data = a, geom = c("point", "line"), xlab = "Year",
main = " US coal combustion related
emissions between 1999 and 2008")
dev.off()
# Coal combustion has steeply declined from 2006 to 2008
# 4. Across the United States, how have emissions from coal combustion-related sources changed from 1999–2008?
combSCCs <- SCC$SCC[grepl("Coal", SCC$SCC.Level.Three) | grepl("Coal", SCC$SCC.Level.Three)]
# combSCCs <-  SCC$SCC[SCC$EI.Sector == "Fuel Comb - Electric Generation - Coal"]
x <- NEI[NEI$SCC %in% combSCCs,]
a <- aggregate(x$Emissions, by = list(x$year), sum)
names(a) <- c("year","Emissions")
png("wk4_4.png")
qplot(year, Emissions, data = a, geom = c("point", "line"), xlab = "Year",
main = " US coal combustion related emissions between 1999 and 2008")
dev.off()
# Coal combustion has steeply declined from 2006 to 2008
# 1. Have total emissions from PM2.5 decreased in the United States from 1999 to 2008? Using the base plotting system, make a plot showing the total PM2.5 emission from all sources for each of the years 1999, 2002, 2005, and 2008.
a <- tapply(NEI$Emissions, NEI$year, sum)
png("plot1.png")
plot(names(a), a,type = "l", main = "Total PM2.5 From All Sources", xlab = "Year", ylab = "PM2.5")
dev.off()
# Emissions have decreased
# 2. Have total emissions from PM2.5 decreased in the Baltimore City, Maryland (fips == "24510") from 1999 to 2008? Use the base plotting system to make a plot answering this question.
baltNEI <- NEI[NEI$fip == "24510", ]
a <- tapply(baltNEI$Emissions, baltNEI$year, sum)
png("plot2.png")
plot(names(a),a, type = "l", main = "Baltimore City, Maryland Total PM2.5", ylab = "PM2.5", xlab = "Year")
dev.off()
# Emissions initially rose in 2005 but the falling trend continued in 2008
# 3. Of the four types of sources indicated by the type (point, nonpoint, onroad, nonroad) variable, which of these four sources have seen decreases in emissions from 1999–2008 for Baltimore City? Which have seen increases in emissions from 1999–2008? Use the ggplot2 plotting system to make a plot answer this question.
baltNEI <- NEI[NEI$fip == "24510", ]
a <- aggregate(baltNEI$Emissions, by = list(baltNEI$year, baltNEI$type), sum)
names(a) <- c("year","type","Emissions")
png("plot3.png")
qplot(year, Emissions, data = a, col = type, geom = c("point", "line"),
main = "Baltimore City PM2.5 emission by type between 1999 and 2008",
xlab = "Year")
dev.off()
# Non-road, Nonpoint, and On-Road have decreased while Point has increased
# 4. Across the United States, how have emissions from coal combustion-related sources changed from 1999–2008?
combSCCs <- SCC$SCC[grepl("Coal", SCC$SCC.Level.Three) | grepl("Coal", SCC$SCC.Level.Three)]
# combSCCs <-  SCC$SCC[SCC$EI.Sector == "Fuel Comb - Electric Generation - Coal"]
x <- NEI[NEI$SCC %in% combSCCs,]
a <- aggregate(x$Emissions, by = list(x$year), sum)
names(a) <- c("year","Emissions")
png("plot4.png")
qplot(year, Emissions, data = a, geom = c("point", "line"), xlab = "Year",
main = " US coal combustion related emissions between 1999 and 2008")
dev.off()
# Coal combustion has steeply declined from 2006 to 2008
# 5. How have emissions from motor vehicle sources changed from 1999–2008 in Baltimore City?
unique(SCC$EI.Sector)
unique(SCC$Short.Name[grep("Motor Vehicle", SCC$Short.Name)])
# motSCCs <- SCC$SCC[grep("Motor", SCC$Short.Name)]
motSCCs <- SCC$SCC[SCC$SCC.Level.One == "Mobile Sources"]
x <- baltNEI[baltNEI$SCC %in% motSCCs,]
a <- aggregate(x$Emissions, by = list(x$year), sum)
names(a) <- c("year","Emissions")
png("plot5.png")
qplot(year, Emissions, data = a, geom = c("point", "line"),
main = "Emissions from Mobile Sources in Baltimore City from 1999 to 2008",
xlab = "Year")
dev.off()
# Emissions from mobile sources steeply fell from 2000 to 2002 and then slighly rose through 2005 and 2008
# 6. Compare emissions from motor vehicle sources in Baltimore City with emissions from motor vehicle sources in Los Angeles County, California (fips == "06037"). Which city has seen greater changes over time in motor vehicle emissions?
laNEI <- NEI[NEI$fip == "06037" &  NEI$SCC %in% motSCCs, ]
laVbalNEI <- NEI[(NEI$fip == "06037" | NEI$fip == "24510") &  (NEI$SCC %in% motSCCs) &
!is.na(NEI$Emissions), ]
otherThing <- as.numeric(scale(laVbalNEI$Emissions))
thing <- by(laVbalNEI$Emissions, laVbalNEI$fips, function(x){
unlist(as.numeric(scale(x)))})
newThing <- unlist(c(thing[1:2]))
laVbalNEI$Emissions_Scaled <- newThing
laVbalNEI$city <- unlist(lapply(laVbalNEI$fips, function(x){
switch(x, "06037" = "LA", "24510" = "Baltimore City")}
))
a <- aggregate(laVbalNEI$Emissions_Scaled, by = list(laVbalNEI$year,laVbalNEI$city), mean)
names(a) <- c("year","city","Emissions")
png("plot6.png")
qplot(year, Emissions, data = a, col = city, geom = c("point", "line"),
main = "Baltimore City and LA Emissions from Mobile Sources 1999-2008 (Z-scores)",
xlab = "Year")
dev.off()
# Baltimore City decrease in emissions is more dynamic than LA while LA emissions increased but stabalized
